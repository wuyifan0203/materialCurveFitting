<a name="LvXmQ"></a>
# éœ€è¦äº†è§£çš„å…¬å¼
<a name="E7r1J"></a>
## å…¬å¼ä¸€
çœŸç©ºä»‹ç”µå¸¸é‡æ˜¯ç‰©ç†é‡åœ¨åº¦é‡æ—¶å¼•è¿›çš„å¸¸æ•°(ä¸»è¦æ˜¯åº“ä»‘å®šå¾‹ä¸­å¯¹ç”µè·é‡çš„åº¦é‡)ï¼Œæ ¹æ®éº¦å…‹æ–¯éŸ¦æ–¹ç¨‹ç»„ï¼Œå¯æ¨çŸ¥çœŸç©ºä»‹ç”µå¸¸æ•°ä¸å…¶å®ƒç‰©ç†å¸¸æ•°çš„å…³ç³»ï¼š<br />![](https://cdn.nlark.com/yuque/0/2021/jpeg/25638087/1640829257428-35527a13-a754-4911-8e50-6b7cf8037a25.jpeg#clientId=uf9577f2a-5334-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u543553da&margin=%5Bobject%20Object%5D&originHeight=46&originWidth=81&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u74694dac-5428-4da7-8b29-c0759647aae&title=)<br />å…¶ä¸­ï¼Œ<br />![](https://cdn.nlark.com/yuque/0/2021/jpeg/25638087/1640829359762-a9a53ddd-d129-4f1e-9cf4-aa5360f9362e.jpeg#clientId=uf9577f2a-5334-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u7dc61bac&margin=%5Bobject%20Object%5D&originHeight=21&originWidth=157&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u26d3cfd2-35d4-4cfa-869d-104c1b835b5&title=)<br />_Îµ0ä¸ºçœŸç©ºä»‹ç”µå¸¸æ•°ï¼Œå€¼ä¸º8.854187817*10^-12 F/m_<br />cä¸ºå…‰é€Ÿ<br />

<a name="a5fNk"></a>
## å…¬å¼äºŒ
å…‰é€Ÿä¸æ³¢é•¿ï¼Œé¢‘ç‡çš„å…³ç³»<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/25638087/1640852838704-75cac76f-c686-456f-80d3-699881e0438b.png#clientId=u3c323c1c-af86-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=48&id=u2c02f86c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=48&originWidth=81&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1011&status=done&style=none&taskId=ue2c6537f-4a24-43eb-86e6-db71b2d7dd2&title=&width=81)<br />å…¶ä¸­ï¼Œcä¸ºå…‰é€Ÿï¼Œfä¸ºé¢‘ç‡ï¼ŒÎ»ä¸ºæ³¢é•¿ã€‚<br />â€‹<br />
<a name="WJeK6"></a>
## å…¬å¼ä¸‰
E = hv<br />å…¶ä¸­ï¼ŒEä¸ºèƒ½é‡ï¼Œhä¸ºæ™®æœ—å…‹å¸¸æ•°ï¼Œvä¸ºé¢‘ç‡ã€‚<br />h = 6.6260755e-34 JÂ·s<br />â€‹<br />
<a name="bOkda"></a>
## å…¬å¼å››
RMSE[å‡æ–¹æ ¹è¯¯å·®å…¬å¼](https://baike.baidu.com/item/%E5%9D%87%E6%96%B9%E6%A0%B9%E8%AF%AF%E5%B7%AE/3498959?fromtitle=RMSE&fromid=6536667&fr=aladdin)<br />RMSE = $$\sqrt{\frac{1}{m}\sum_{n=1}^m |y_d - y_i|^2 }$$<br />â€‹<br />
<a name="BGAxE"></a>
## å…¬å¼äº”
ä»‹ç”µå¸¸æ•°ä¸æåŒ–ç‡å…¬å¼<br />![ä¼ä¸šå¾®ä¿¡æˆªå›¾_16400837131913.png](https://cdn.nlark.com/yuque/0/2021/png/25638087/1640831678381-fa15bdd2-2299-49e5-b070-f8b48c847502.png#clientId=uf9577f2a-5334-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=137&id=u0c27af26&margin=%5Bobject%20Object%5D&name=%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_16400837131913.png&originHeight=308&originWidth=830&originalType=binary&ratio=1&rotation=0&showTitle=false&size=42058&status=done&style=none&taskId=u5329c961-de2a-4b4e-9a88-77ddb2a7f03&title=&width=368)<br />
<br />æ¥ä¸‹æ¥ï¼Œå°±å¯ä»¥æ­£å¼å¼€å§‹ææ–™æ‹Ÿåˆäº†<br />â€‹<br />
<a name="zHMDY"></a>
# ä»£ç ä¹¦å†™
æ³¨ï¼šæœ¬æ¬¡æ‹Ÿåˆææ–™ä»¥Siä¸ºä¾‹
<a name="qdJNv"></a>
## æ­¥éª¤
å°†æ•´ä½“åˆ†ä¸ºä¸‰æ­¥ğŸš¶â€â™€ï¸è®¡ç®—

1. è®¡ç®—æåŒ–ç‡ï¼ˆå…¬å¼äº”çš„Xkï¼‰ï¼›
1. è®¡ç®—æ‹Ÿåˆç‚¹ï¼ˆå…¬å¼ä¸€çš„_Îµr_ï¼‰ï¼›
1. è®¡ç®—å‡æ–¹æ ¹è¯¯å·®ï¼›



<a name="lDPRu"></a>
## ä»£ç 
<a name="PrNi0"></a>
### 1.è®¡ç®—æåŒ–ç‡
![image.png](https://cdn.nlark.com/yuque/0/2021/png/25638087/1640853334198-57735fb2-2d6b-4870-aa0d-9c30aeabc85e.png#clientId=uec2524fb-2b0b-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=48&id=u1e775c2c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=54&originWidth=68&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2256&status=done&style=none&taskId=ub6d9e403-2b99-4409-b427-415f2e9409b&title=&width=60)![image.png](https://cdn.nlark.com/yuque/0/2021/png/25638087/1640846354672-12714f39-62d5-4a1a-981f-9e53558676e8.png#clientId=ua0a95876-f94c-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=45&id=WgqfR&margin=%5Bobject%20Object%5D&name=image.png&originHeight=45&originWidth=137&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5270&status=done&style=none&taskId=u3f2cad2b-4b5b-4bc6-bda6-4e895e0cf8d&title=&width=137)<br />rkã€rk*ã€pkã€pk*ä¸ºå¤æ•°ï¼Œrkä¸rk*ï¼Œpkä¸pk*äº’ä¸ºå…±è½­å¤æ•°<br />ç”±äºJavaScriptæ²¡æœ‰å¤æ•°ç±»å‹ï¼Œè¿›è¡Œæ‹†è§£ï¼Œæ–¹ä¾¿è®¡ç®—<br />è®¾

- rk  = a + bi
- rk* = a - bi
- pk = c + di
- pk* = c - di

æ¥ä¸‹æ¥è¿›è¡Œé€šåˆ†ï¼Œæ¯”è¾ƒå¤æ‚æ¶å¿ƒï¼Œä¸”å®¹æ˜“å‡ºé”™ï¼Œå°±ä¸åœ¨è¿™é‡ŒåŒ–ç®€äº†<br />â€‹

æœ€ååŒ–ç®€å¥½ï¼Œå°†å®éƒ¨è™šéƒ¨åŒ–æˆå½¢å¦‚æ ¼å¼ ä¸º`X + Y i `å°±å¯ä»¥äº†<br />å…¥å‚ä¸º(a,b,c,d,w) è¿”å›å€¼ä¸ºæ•°ç»„åˆ†åˆ«å­˜å‚¨ `X`ä¸`Y`ï¼Œ<br />ç¬¬ä¸€æ­¥å°±å®Œæˆäº†ï¼Œä»£ç å¦‚ä¸‹ï¼›
```javascript
const Xk = ({w,a,b,c,d }) => {
        const [C2,W2,D2] = [c * c,w * w,d * d];
        const ac = a * c;
        const bd = b * d;
        const P = -W2+C2+H2;
        const Y =(-2*(ac+bd));
        const X = 2*a*w;
        const Q = -2*c*w
        const denominator = (-W2+C2+D2)*(-W2+C2+D2)+4*W2*C2;
        const real =Y*P+X*Q;
        const imag = X*P-Y*Q;
        return [real / denominator, imag / denominator]
}
```


<a name="Mtmr2"></a>
### 2.è®¡ç®—æ‹Ÿåˆç‚¹
![image.png](https://cdn.nlark.com/yuque/0/2021/png/25638087/1640848417739-fc7e51d0-59e0-4b4b-aaf3-3dd88f4e497d.png#clientId=ua0a95876-f94c-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=54&id=ud4ab786f&margin=%5Bobject%20Object%5D&name=image.png&originHeight=54&originWidth=190&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6642&status=done&style=none&taskId=u9069b2f6-a459-4a0c-8947-2dd6e96b521&title=&width=190)<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/25638087/1640848319800-832ce820-e56c-4f5c-98ef-0d4ae4b05003.png#clientId=ua0a95876-f94c-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=14&id=ua6be757e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=14&originWidth=22&originalType=binary&ratio=1&rotation=0&showTitle=false&size=698&status=done&style=none&taskId=u2e47229a-a783-4066-becf-f7c59d2eaa9&title=&width=22)=1<br />é»˜è®¤ä¸‰å¯¹æç‚¹ L=3<br />å°†ä¸‰ç»„ç³»æ•°å­˜å‚¨åœ¨coeä¸­
```javascript
const coe = [
  {
    a:xxxx,
    b:xxxx,
    c:xxxx,
    d:xxxx
  },
  ...
]
```
å…¥å‚ä¸º(coe,Woo,w) è¿”å›å€¼ä¾ç„¶ä¸ºå¤æ•°æ•°ç»„åˆ†åˆ«å­˜å‚¨ï¼Œ<br />ç¬¬äºŒæ­¥å°±å®Œæˆäº†ï¼Œä»£ç å¦‚ä¸‹ï¼š
```javascript
const Rw = (w, Woo,coe) => {
        const result = [0, 0]
        for (let i = 0; i < coe.length; i++) {
            const currentCoe = coe[i]
            const XkResult = Xk({
                w,
                a: currentCoe.a,
                b: currentCoe.b,
                c: currentCoe.c,
                d: currentCoe.d
            });
            result[0] += XkResult[0];
            result[1] += XkResult[1]
        }
        result[0] = result[0] + Woo
        return result
}
```


<a name="v1YrW"></a>
### 3.è®¡ç®—å‡æ–¹æ ¹è¯¯å·®
RMSE = $$\sqrt{\frac{1}{m}\sum_{n=1}^m |y_d - y_i|^2 }$$<br />mä¸ºç‚¹çš„ä¸ªæ•°<br />é€šè¿‡ç¬¬äºŒæ­¥ï¼Œå·²ç»æ±‚å‡ºäº†æ‹Ÿåˆç‚¹ï¼Œè¿™æ—¶å€™éœ€è¦è®¡ç®—ä¸€ä¸ªç‚¹çš„è¯¯å·®<br />`å•ç‚¹è¯¯å·® = å®é™…æµ‹é‡ç‚¹ - æ‹Ÿåˆç‚¹`<br />ä½†ç”±äºå®é™…æµ‹é‡ç‚¹ä¸æ‹Ÿåˆç‚¹éƒ½æ˜¯å¤æ•°ï¼Œæ‰€ä»¥é‡‡ç”¨<br />`å•ç‚¹å®éƒ¨è¯¯å·® = å®é™…æµ‹é‡ç‚¹å®éƒ¨ - æ‹Ÿåˆç‚¹å®éƒ¨`<br />`å•ç‚¹è™šéƒ¨è¯¯å·® = å®é™…æµ‹é‡ç‚¹è™šéƒ¨ - æ‹Ÿåˆç‚¹è™šéƒ¨`<br />æœ€ååœ¨å¹³æ–¹æ±‚å’Œï¼Œé™¤ä»¥ç‚¹æ•°ï¼Œå¼€æ ¹å·ï¼Œå³å¯å®Œæˆè®¡ç®—<br />â€‹

è®¡ç®—åŠ æƒè¯¯å·®<br />`åŠ æƒè¯¯å·® = è¯¯å·®è™šéƒ¨çš„å¹³æ–¹çš„å’Œ x æƒé‡`<br />â€‹

å…¥å‚ä¸º({materialId,wavelength_min,wavelength_max,weight,coe,max_of_number}) <br />è¿”å›å€¼ä¸ºå¯¹è±¡{RMSE,weightedRMSE,RwList}ï¼Œ<br />ç¬¬ä¸‰æ­¥å°±å®Œæˆäº†ï¼Œä»£ç å¦‚ä¸‹ï¼š
```javascript
const materialCurveFitting = ({
    materialId,
    wavelength_min,
    wavelength_min,
    max_of_number = 6, // æç‚¹ä¸ªæ•°ï¼Œä¸‰å¯¹æç‚¹
    weight,
    coe=primaryCoe
}) => {
    //ä»æ•°æ®åº“æå–æ‰€éœ€ææ–™çš„ç¬¦åˆwavelength_minï¼Œwavelength_maxä¹‹é—´æ‰€æœ‰çš„ç‚¹
    // æ³¨æ„ âš ï¸ åº”è¯¥ä¸ºé—­åŒºé—´
    let list = materialParams.filter(e => e.wavelength <= wavelength_max && e.wavelength >= wavelength_min);
    //
    const Woo = 1;
    
    let subReal=0; //å®éƒ¨æ€»å’Œåˆå§‹åŒ–
    let subVirtual=0; //è™šéƒ¨æ€»å’Œåˆå§‹åŒ–
    const RwList=[]ï¼›//æ‰€æœ‰æ‹Ÿåˆç‚¹çš„å®éƒ¨è™šéƒ¨çš„é›†åˆ

    for (var i=list.length-1;i>=0;i--) {
        let target = list[i];
        const currentWavelength=target.wavelength*1000000 //è½¬æ¢å¾®ç±³
        //å…¬å¼ä¸€
        const w = 2*Math.PI*c0/ (currentWavelength * 1e-6)
        const h = 6.6260755e-34; // J * s
        //å…¬å¼ä¸‰
        const eV_J = 1.6021766208e-19; // 1 eV =1.6021766208e-19 
        //å…¬å¼äºŒ
        const omega = w / (2*Math.PI) * h /eV_J;//ç”µå­ä¼å•ä½
        
        //è®¡ç®—æ‹Ÿåˆç‚¹
        const RwResult = Rw(omega,Woo,coe);
        RwList.push(RwResult);
       
        const DetaReal = RwResult[0]-target.epsRe;
        const DetaVirtual = RwResult[1]+target.epsIm;
        //æ±‚å’Œ
        subReal+=DetaReal*DetaReal;
        subVirtual+= DetaVirtual*DetaVirtual;
    }
    // console.log('---------------------start------------------------------');
    // console.log("subreal",subReal);
    // console.log("subVirtual",subVirtual);
  
    // RMSE çš„è®¡ç®—
    const RMSE = Math.sqrt((subVirtual+subReal)/list.length);
    // åŠ æƒåçš„RMSE
    const weightedRMSE =Math.sqrt((weight*subVirtual+subReal)/list.length);
    
    // console.log('list length:',list.length);
    // console.log('RMSE :',RMSE);
    // console.log('-----------------------end------------------------------');
    return {RMSE,weightedRMSE,RwList}
};
```
å…¶ä¸­c0é€šè¿‡å…¬å¼ä¸€è®¡ç®—
```javascript
const eps0 = 8.854187817e-12;
const mu0 = 4*Math.PI*1e-7;
var c0 = 1/Math.sqrt(eps0*mu0);
```


<a name="ZQtdy"></a>
# å‡½æ•°è°ƒç”¨
```javascript
const { RMSE, weightedRMSE, RwList } = materialCurveFitting({
    wavelength_min: 0.2e-6,
    wavelength_max: 2.0e-6,
    weight: 1,
})
console.log('æ‹Ÿåˆè¯¯å·®ï¼š',RMSE);
console.log('åŠ æƒæ‹Ÿåˆè¯¯å·®ï¼š',weightedRMSE);
console.log('æ‹Ÿåˆç‚¹é›†åˆï¼š',RwList);
```
â€‹<br />
<a name="uonmH"></a>
# è‡´è°¢
éå¸¸æ„Ÿè°¢æŠ€æœ¯éƒ¨ _åˆ˜ç¦ _è€å¸ˆæä¾›æŠ€æœ¯æŒ‡å¯¼ä»¥åŠæ–‡æ¡£çš„è®¢æ­£

